<aside class="left-sidebar with-vertical">
	<div><!-- ---------------------------------- -->

		<!-- Start Vertical Layout Sidebar -->
		<!-- ---------------------------------- -->
		<div class="brand-logo d-flex align-items-center justify-content-between">
			<a href="#" class="text-nowrap logo-img">
			</a>
			<a
				href="javascript:void(0)"
				class="sidebartoggler ms-auto text-decoration-none fs-5 d-block d-xl-none"
			>
				<i class="ti ti-x"></i>
			</a>
		</div>

		<nav class="sidebar-nav scroll-sidebar" data-simplebar>
			<ul id="sidebarnav">
				<li class="nav-small-cap">
					<i class="ti ti-dots nav-small-cap-icon fs-4"></i>
					<span class="hide-menu">Menu</span>
				</li>
                <li class="sidebar-item">
                    <a class="sidebar-link" asp-controller="Dashboard" asp-action="Index"
                       aria-expanded="false">
                        <span>
                            <i class="ti ti-home"></i>
                        </span>
                        <span class="hide-menu">Home</span>
                    </a>
                </li>
                
				@if (User.IsInRole("Admin"))
                {
					<li class="sidebar-item">
						<a class="sidebar-link has-arrow"
						   href="javascript:void(0)"
						   aria-expanded="false">
							<span class="d-flex">
								<i class="ti ti-users"></i>
							</span>
							<span class="hide-menu">User Management</span>
						</a>
						<ul aria-expanded="false" class="collapse first-level">
							<li class="sidebar-item">
								<a asp-controller="Users" asp-action="Upsert" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">Add User</span>
								</a>
							</li>

							<li class="sidebar-item">
								<a asp-controller="Users" asp-action="Index" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">List of Users</span>
								</a>
							</li>

							<li class="sidebar-item">
								<a asp-controller="Users" asp-action="UsersWithSubscriptions" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">Users with Subscriptions</span>
								</a>
							</li>
						</ul>
					</li>

					<li class="sidebar-item">
						<a class="sidebar-link has-arrow"
						   href="javascript:void(0)"
						   aria-expanded="false">
							<span class="d-flex">
								<i class="ti ti-list"></i>
							</span>
							<span class="hide-menu">Ads Management</span>
						</a>
						<ul aria-expanded="false" class="collapse first-level">
							<li class="sidebar-item">
								<a asp-controller="Ads" asp-action="Upsert" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">Add Ads</span>
								</a>
							</li>

							<li class="sidebar-item">
								<a asp-controller="Ads" asp-action="Index" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">All Ads</span>
								</a>
							</li>
						</ul>
					</li>

					<li class="sidebar-item">
						<a class="sidebar-link has-arrow"
						   href="javascript:void(0)"
						   aria-expanded="false">
							<span class="d-flex">
								<i class="ti ti-credit-card"></i>
							</span>
							<span class="hide-menu">Subscriptions</span>
						</a>
						<ul aria-expanded="false" class="collapse first-level">
							<li class="sidebar-item">
								<a asp-controller="Subscriptions" asp-action="Upsert" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">Add Subscription</span>
								</a>
							</li>

							<li class="sidebar-item">
								<a asp-controller="Subscriptions" asp-action="Index" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">All Subscriptions</span>
								</a>
							</li>
						</ul>
					</li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="StudyGroupCategories" asp-action="Index"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-list"></i>
                            </span>
                            <span class="hide-menu">Group Categories</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="StudyGroups" asp-action="Index"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-books"></i>
                            </span>
                            <span class="hide-menu">Group Management</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="StudyGroups" asp-action="AllResources"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-files"></i>
                            </span>
                            <span class="hide-menu">All Resources</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="Feedback" asp-action="Index"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-list"></i>
                            </span>
                            <span class="hide-menu">Feedback Management</span>
                        </a>
                    </li>

					<li class="sidebar-item">
						<a class="sidebar-link has-arrow"
						   href="javascript:void(0)"
						   aria-expanded="false">
							<span class="d-flex">
								<i class="ti ti-report-analytics"></i>
							</span>
							<span class="hide-menu">Reports</span>
						</a>
						<ul aria-expanded="false" class="collapse first-level">
							<li class="sidebar-item">
								<a asp-controller="AuditLogs" asp-action="Index" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">Activity Logs</span>
								</a>
							</li>

							<li class="sidebar-item">
								<a asp-controller="Reports" asp-action="Index" class="sidebar-link">
									<div class="round-16 d-flex align-items-center justify-content-center">
										<i class="ti ti-circle"></i>
									</div>
									<span class="hide-menu">Generate Reports</span>
								</a>
							</li>
						</ul>
					</li>
                }
                else
                {
                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="StudyGroups" asp-action="MyStudyGroups"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-books"></i>
                            </span>
                            <span class="hide-menu">My Study Groups</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="StudyGroups" asp-action="AvailableStudyGroups"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-books"></i>
                            </span>
                            <span class="hide-menu">Available Study Groups</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="Subscriptions" asp-action="AvailablePlans"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-credit-card"></i>
                            </span>
                            <span class="hide-menu">Subscription Plans</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="Meetings" asp-action="MyCalendar"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-calendar"></i>
                            </span>
                            <span class="hide-menu">My Calendar</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="StudyGroups" asp-action="MyResources"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-files"></i>
                            </span>
                            <span class="hide-menu">My Resources</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="AuditLogs" asp-action="MyActivityLogs"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-history"></i>
                            </span>
                            <span class="hide-menu">My Activity Logs</span>
                        </a>
                    </li>

                    <li class="sidebar-item">
                        <a class="sidebar-link" asp-controller="Feedback" asp-action="SubmitFeedback"
                           aria-expanded="false">
                            <span>
                                <i class="ti ti-edit"></i>
                            </span>
                            <span class="hide-menu">Submit a Feedback</span>
                        </a>
                    </li>
                }
			</ul>
		</nav>

		<div
			class="fixed-profile p-3 mx-4 mb-2 bg-secondary-subtle rounded sidebar-ad mt-3"
		>
			<div class="hstack gap-3">
				<div class="john-img">
					<img
						src="~/images/studyconnect_logo.png"
						class="rounded-circle"
						width="40"
						height="40"
						alt="Logo"
					/>
				</div>
				<div class="john-title">
					@{
						var firstName = User.Claims.FirstOrDefault(c => c.Type == "FirstName")?.Value ?? "";
						var lastName = User.Claims.FirstOrDefault(c => c.Type == "LastName")?.Value ?? "";
						var fullName = !string.IsNullOrEmpty(firstName) || !string.IsNullOrEmpty(lastName) 
							? $"{firstName} {lastName}".Trim() 
							: User.Identity?.Name ?? "User";
						
						var userRoles = User.Claims.Where(c => c.Type == System.Security.Claims.ClaimTypes.Role)
							.Select(c => c.Value)
							.ToList();
						var rolesDisplay = userRoles.Any() ? string.Join(", ", userRoles) : "User";
					}
					<h6 class="mb-1 fs-2 fw-semibold">@fullName</h6>
					<span class="fs-2 d-block text-muted">@rolesDisplay</span>
				</div>
				<a asp-controller="Auth" asp-action="Logout" class="border-0 bg-transparent text-primary ms-auto" title="Logout">
					<i class="ti ti-power fs-6"></i>
				</a>
			</div>
		</div>
	</div>
</aside>
