@{
    ViewBag.Title = "My Study Groups";
    Layout = "Dashboard/_Layout";
}

@section Styles
{
    <link rel="stylesheet" href="~/modules/study_groups/my_study_groups.css" asp-append-version="true" />
}

<div class="body-wrapper">
    <div class="container-fluid">
        <div class="card bg-info-subtle shadow-none position-relative overflow-hidden mb-4">
            <div class="card-body px-4 py-3">
                <div class="row align-items-center">
                    <div class="col-9">
                        <h4 class="fw-semibold mb-8">My Study Groups</h4>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item">
                                    <a class="text-muted text-decoration-none" href="#">My Study Groups</a>
                                </li>
                                <li class="breadcrumb-item" aria-current="page">List</li>
                            </ol>
                        </nav>
                    </div>
                    <div class="col-3">
                        <div class="text-center mb-n5">
                            <img src="~/templates/modernize/images/breadcrumb/ChatBc.png"
                                 alt="Breadcrumb logo"
                                 class="img-fluid mb-n4" />
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @if (ViewBag.IsSubscriptionExpired == true)
        {
            <div class="alert alert-danger alert-dismissible fade show mb-4" role="alert">
                <div class="d-flex align-items-center">
                    <i class="ti ti-alert-triangle fs-5 me-3"></i>
                    <div class="flex-grow-1">
                        <h5 class="alert-heading mb-1">Subscription Expired</h5>
                        <p class="mb-0">@ViewBag.ExpiredMessage</p>
                    </div>
                    <a href="@Url.Action("AvailablePlans", "Subscriptions")" class="btn btn-danger btn-sm ms-3">
                        <i class="ti ti-shopping-cart me-1"></i>Upgrade Now
                    </a>
                </div>
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
        }

        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h5 class="mb-0">My Study Groups</h5>
                        <p class="card-subtitle mb-0 mt-1 text-muted">
                            List of all my study groups
                        </p>
                    </div>
                    <a asp-controller="StudyGroups" asp-action="Upsert" class="btn btn-primary">
                        <i class="ti ti-plus me-1"></i> Create New Group
                    </a>
                </div>

                <!-- DevExtreme Search Box for filtering -->
                <div class="mb-4">
                    <label for="searchBox" class="form-label">Search by Group Name</label>
                    <div id="searchBox"></div>
                </div>

                <!-- Loading Indicator -->
                <div id="loadingIndicator" class="text-center py-5" style="display: none;">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                    <p class="mt-2 text-muted">Loading study groups...</p>
                </div>

                <!-- Empty State -->
                <div id="emptyState" class="text-center py-5" style="display: none;">
                    <i class="ti ti-folder-off" style="font-size: 4rem; color: #ccc;"></i>
                    <h5 class="mt-3">No Study Groups Found</h5>
                    <p class="text-muted">You haven't joined any study groups yet.</p>
                    <a asp-controller="StudyGroups" asp-action="Upsert" class="btn btn-primary mt-2">
                        <i class="ti ti-plus me-1"></i> Create Your First Group
                    </a>
                </div>

                <!-- Study Groups Container -->
                <div id="studyGroupsContainer" class="row">
                    <!-- Study group cards will be dynamically inserted here -->
                </div>
            </div>
        </div>
    </div>
</div>

@section FooterScripts {
    <script src="~/modules/study_groups/footer_my_study_groups.js" asp-append-version="true"></script>
}